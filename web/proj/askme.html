<!--%c ssr_template_default_before(ssr_sb, ssr_data); %-->

<div class="rcontent">
	<div class="rbox">
		<h2>
				<span class="lang_en">Ask me, bro</span>
				<span class="lang_ru">Задай вопрос, бро</span>
		</h2>
		<div style="display: flex; justify-content: center; gap: 10px;">
			<input id="askme_question" type="text" autocomplete="off" placeholder='<!--%cSSR_EN_PRINTF("Question text"); SSR_RU_PRINTF("Текст вопроса");%-->'></input>
			<button id="askme_send_btn" onclick="SendAskmeQuestion()">Send</button>
		</div>
		<p id="askme_result">
		<span id="askme_status_ok">
			<span class="lang_en">Question sent successefuly.</span>
			<span class="lang_ru">Вопрос успешно отправлен.</span>
		</span>
		<span id="askme_status_long">
			<span class="lang_en">Error. Question is too long!</span>
			<span class="lang_ru">Ошибка. Вопрос слишком длинный!</span>
		</span>
		<span id="askme_status_empty">
			<span class="lang_en">Error. Question empty!</span>
			<span class="lang_ru">Ошибка. Вопрос пустой!</span>
		</span>
		<span id="askme_status_freq">
			<span class="lang_en">Error. Sending too frequently!</span>
			<span class="lang_ru">Ошибка. Слишком часто отправляешь!</span>
		</span>
		</p>
	</div>
</div>
<script src="enums.js"></script> <!-- Generated -->
<script src="utils/binary_rw.js"></script>
<script>
	const askme_question_el = document.getElementById("askme_question");
	const askme_result_el = document.getElementById("askme_question");
	const askme_send_btn_el = document.getElementById("askme_send_btn");
	askme_question_el.addEventListener("keydown", function(event) {
		if (event.key === "Enter") {
			event.preventDefault();
			askme_send_btn_el.click();
		}
	});
	function SendAskmeQuestion() {
		const writer = new ByteWriter();
		writer.u16(CME.ASKME_QUESTION);
		writer.str(askme_question_el.value);
		fetch('/binary', { method: 'POST', body: new Uint8Array(writer.arr) })
			.then(resp => resp.arrayBuffer())
			.then(buf => HandleAskmeServerResponse(buf));
	}
	function HideStatus() {
		Array.from(askme_result.children).forEach(c => { c.style.display = "none"; });
	}
	HideStatus();
	function HandleAskmeServerResponse(buf) {
		const reader = new ByteReader(buf);
		var code = reader.u8();
		HideStatus();
		switch (code) {
			case 0: askme_status_ok.style.display    = "unset"; break;
			case 1: askme_status_long.style.display  = "unset"; break;
			case 2: askme_status_empty.style.display = "unset"; break;
			case 3: askme_status_freq.style.display  = "unset"; break;
		}
	}
</script>

<!--%c ssr_template_default_after(ssr_sb, ssr_data); %-->
